package com.openske.rules;

/**
 * Software Rules
 */

import com.openske.model.software.Software;
import com.openske.model.security.SecurityState;


rule "Mark any software with vulnerabilities or depends on vulnerable software as risky"
    when
        $software : Software( vulnerabilities.size > 0 )
        or
        (
            $riskyDependency : Software( securityState == SecurityState.RISKY )
            and
            $software : Software( dependencies contains $riskyDependency )
        )
    then
        System.out.println("[DRL] Setting " + $software + " as risky");
        $software.setSecurityState(SecurityState.RISKY);
end
